import geopandas as gpd
import pandas as pd
from shapely import wkt

summary_data = [
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "peak_step": 1,
        "peak_day": "2023-11-07T00:00:00",
        "peak_timing": "BB",
        "max_median_dis": 314.96875,
        "min_median_dis": 89.9921875,
        "control_dis": 314.96875,
        "max_max_dis": 340.7265625,
        "min_min_dis": 67.703125,
        "tendency": "D",
        "max_p_above_20y": 1.0,
        "max_p_above_5y": 1.0,
        "max_p_above_2y": 1.0,
        "intensity": "P",
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "peak_step": 1,
        "peak_day": "2023-11-07T00:00:00",
        "peak_timing": "BB",
        "max_median_dis": 308.78125,
        "min_median_dis": 89.0625,
        "control_dis": 308.78125,
        "max_max_dis": 334.60546875,
        "min_min_dis": 67.109375,
        "tendency": "D",
        "max_p_above_20y": 1.0,
        "max_p_above_5y": 1.0,
        "max_p_above_2y": 1.0,
        "intensity": "P",
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
]

detailed_data = [
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-26T00:00:00",
        "step": 19,
        "p_above_2y": 0.058823529411764705,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 118.8203125,
        "Q1_dis": 138.2265625,
        "median_dis": 150.21875,
        "Q3_dis": 160.7890625,
        "max_dis": 194.08984375,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-12T00:00:00",
        "step": 5,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 0.37254901960784315,
        "min_dis": 249.18359375,
        "Q1_dis": 259.94921875,
        "median_dis": 263.89453125,
        "Q3_dis": 271.1484375,
        "max_dis": 314.9921875,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-25T00:00:00",
        "step": 18,
        "p_above_2y": 0.09803921568627451,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 126.0078125,
        "Q1_dis": 144.41796875,
        "median_dis": 157.3203125,
        "Q3_dis": 168.8125,
        "max_dis": 194.6171875,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-08T00:00:00",
        "step": 1,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 1.0,
        "min_dis": 314.9375,
        "Q1_dis": 314.95703125,
        "median_dis": 314.96875,
        "Q3_dis": 314.98828125,
        "max_dis": 316.1796875,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-22T00:00:00",
        "step": 15,
        "p_above_2y": 0.37254901960784315,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 149.1953125,
        "Q1_dis": 167.3828125,
        "median_dis": 175.40234375,
        "Q3_dis": 188.71875,
        "max_dis": 211.5078125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-18T00:00:00",
        "step": 11,
        "p_above_2y": 1.0,
        "p_above_5y": 0.11764705882352941,
        "p_above_20y": 0.0,
        "min_dis": 183.85546875,
        "Q1_dis": 194.1328125,
        "median_dis": 200.05078125,
        "Q3_dis": 205.95703125,
        "max_dis": 252.046875,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-12-04T00:00:00",
        "step": 27,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 75.609375,
        "Q1_dis": 95.82421875,
        "median_dis": 103.2734375,
        "Q3_dis": 112.078125,
        "max_dis": 163.0,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-11T00:00:00",
        "step": 4,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 0.9607843137254902,
        "min_dis": 264.77734375,
        "Q1_dis": 274.3203125,
        "median_dis": 278.61328125,
        "Q3_dis": 287.45703125,
        "max_dis": 330.8125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-24T00:00:00",
        "step": 17,
        "p_above_2y": 0.1568627450980392,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 133.58203125,
        "Q1_dis": 152.296875,
        "median_dis": 162.15625,
        "Q3_dis": 175.671875,
        "max_dis": 201.95703125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-27T00:00:00",
        "step": 20,
        "p_above_2y": 0.058823529411764705,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 112.05859375,
        "Q1_dis": 132.16796875,
        "median_dis": 142.53515625,
        "Q3_dis": 152.765625,
        "max_dis": 195.04296875,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-14T00:00:00",
        "step": 7,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 0.0392156862745098,
        "min_dis": 223.30078125,
        "Q1_dis": 232.68359375,
        "median_dis": 236.73046875,
        "Q3_dis": 244.5390625,
        "max_dis": 282.74609375,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-12-01T00:00:00",
        "step": 24,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 89.015625,
        "Q1_dis": 109.61328125,
        "median_dis": 119.546875,
        "Q3_dis": 130.06640625,
        "max_dis": 178.15625,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-12-05T00:00:00",
        "step": 28,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 71.8984375,
        "Q1_dis": 90.56640625,
        "median_dis": 100.4375,
        "Q3_dis": 108.8984375,
        "max_dis": 155.5546875,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-12-02T00:00:00",
        "step": 25,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 84.16015625,
        "Q1_dis": 106.078125,
        "median_dis": 114.28125,
        "Q3_dis": 123.90234375,
        "max_dis": 173.7421875,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-23T00:00:00",
        "step": 16,
        "p_above_2y": 0.29411764705882354,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 141.21875,
        "Q1_dis": 160.10546875,
        "median_dis": 166.3203125,
        "Q3_dis": 185.35546875,
        "max_dis": 210.38671875,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-09T00:00:00",
        "step": 2,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 1.0,
        "min_dis": 298.79296875,
        "Q1_dis": 303.33984375,
        "median_dis": 306.38671875,
        "Q3_dis": 310.42578125,
        "max_dis": 328.20703125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-17T00:00:00",
        "step": 10,
        "p_above_2y": 1.0,
        "p_above_5y": 0.17647058823529413,
        "p_above_20y": 0.0,
        "min_dis": 192.53125,
        "Q1_dis": 204.609375,
        "median_dis": 208.75390625,
        "Q3_dis": 215.328125,
        "max_dis": 264.1015625,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-12-03T00:00:00",
        "step": 26,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 79.578125,
        "Q1_dis": 101.0703125,
        "median_dis": 108.7265625,
        "Q3_dis": 117.04296875,
        "max_dis": 168.9375,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-10T00:00:00",
        "step": 3,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 1.0,
        "min_dis": 281.58984375,
        "Q1_dis": 290.14453125,
        "median_dis": 294.67578125,
        "Q3_dis": 303.19140625,
        "max_dis": 340.7265625,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-12-06T00:00:00",
        "step": 29,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 69.3671875,
        "Q1_dis": 86.234375,
        "median_dis": 95.140625,
        "Q3_dis": 105.3515625,
        "max_dis": 149.2578125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-21T00:00:00",
        "step": 14,
        "p_above_2y": 0.5686274509803921,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 157.7734375,
        "Q1_dis": 173.8359375,
        "median_dis": 183.7265625,
        "Q3_dis": 193.21484375,
        "max_dis": 218.62890625,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-12-07T00:00:00",
        "step": 30,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 67.703125,
        "Q1_dis": 83.78125,
        "median_dis": 89.9921875,
        "Q3_dis": 103.89453125,
        "max_dis": 143.58203125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-29T00:00:00",
        "step": 22,
        "p_above_2y": 0.0196078431372549,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 99.77734375,
        "Q1_dis": 119.42578125,
        "median_dis": 131.58984375,
        "Q3_dis": 140.73046875,
        "max_dis": 192.7890625,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-30T00:00:00",
        "step": 23,
        "p_above_2y": 0.0196078431372549,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 94.21875,
        "Q1_dis": 113.94921875,
        "median_dis": 124.05859375,
        "Q3_dis": 133.99609375,
        "max_dis": 182.6875,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-15T00:00:00",
        "step": 8,
        "p_above_2y": 1.0,
        "p_above_5y": 0.9019607843137255,
        "p_above_20y": 0.0196078431372549,
        "min_dis": 213.12109375,
        "Q1_dis": 223.4140625,
        "median_dis": 228.14453125,
        "Q3_dis": 235.0390625,
        "max_dis": 274.578125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-19T00:00:00",
        "step": 12,
        "p_above_2y": 0.8823529411764706,
        "p_above_5y": 0.0784313725490196,
        "p_above_20y": 0.0,
        "min_dis": 173.8515625,
        "Q1_dis": 186.265625,
        "median_dis": 193.15234375,
        "Q3_dis": 203.80859375,
        "max_dis": 242.0078125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-28T00:00:00",
        "step": 21,
        "p_above_2y": 0.0392156862745098,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 105.71875,
        "Q1_dis": 126.33203125,
        "median_dis": 137.23828125,
        "Q3_dis": 145.28125,
        "max_dis": 199.140625,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-13T00:00:00",
        "step": 6,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 0.0784313725490196,
        "min_dis": 235.20703125,
        "Q1_dis": 246.40625,
        "median_dis": 249.80859375,
        "Q3_dis": 258.39453125,
        "max_dis": 298.125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-16T00:00:00",
        "step": 9,
        "p_above_2y": 1.0,
        "p_above_5y": 0.5490196078431373,
        "p_above_20y": 0.0,
        "min_dis": 202.0078125,
        "Q1_dis": 214.6640625,
        "median_dis": 219.125,
        "Q3_dis": 224.75,
        "max_dis": 266.48828125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-20T00:00:00",
        "step": 13,
        "p_above_2y": 0.7450980392156863,
        "p_above_5y": 0.058823529411764705,
        "p_above_20y": 0.0,
        "min_dis": 167.1328125,
        "Q1_dis": 180.2578125,
        "median_dis": 187.65625,
        "Q3_dis": 196.75,
        "max_dis": 229.1640625,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-12-02T00:00:00",
        "step": 25,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 83.1640625,
        "Q1_dis": 104.671875,
        "median_dis": 112.42578125,
        "Q3_dis": 121.96484375,
        "max_dis": 171.0546875,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-17T00:00:00",
        "step": 10,
        "p_above_2y": 1.0,
        "p_above_5y": 0.1568627450980392,
        "p_above_20y": 0.0,
        "min_dis": 189.19921875,
        "Q1_dis": 200.74609375,
        "median_dis": 205.09375,
        "Q3_dis": 211.26953125,
        "max_dis": 259.4765625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-24T00:00:00",
        "step": 17,
        "p_above_2y": 0.11764705882352941,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 131.421875,
        "Q1_dis": 149.7890625,
        "median_dis": 159.625,
        "Q3_dis": 172.9765625,
        "max_dis": 198.51171875,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-12T00:00:00",
        "step": 5,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 0.3137254901960784,
        "min_dis": 244.4296875,
        "Q1_dis": 254.7734375,
        "median_dis": 258.78125,
        "Q3_dis": 265.81640625,
        "max_dis": 309.2578125,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-22T00:00:00",
        "step": 15,
        "p_above_2y": 0.3333333333333333,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 146.67578125,
        "Q1_dis": 164.68359375,
        "median_dis": 172.625,
        "Q3_dis": 185.17578125,
        "max_dis": 207.859375,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-15T00:00:00",
        "step": 8,
        "p_above_2y": 1.0,
        "p_above_5y": 0.8823529411764706,
        "p_above_20y": 0.0196078431372549,
        "min_dis": 209.328125,
        "Q1_dis": 219.234375,
        "median_dis": 224.1953125,
        "Q3_dis": 230.89453125,
        "max_dis": 269.80859375,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-12-05T00:00:00",
        "step": 28,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 71.1953125,
        "Q1_dis": 89.453125,
        "median_dis": 99.1640625,
        "Q3_dis": 107.328125,
        "max_dis": 153.3046875,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-12-07T00:00:00",
        "step": 30,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 67.109375,
        "Q1_dis": 82.921875,
        "median_dis": 89.0625,
        "Q3_dis": 102.83203125,
        "max_dis": 140.9765625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-21T00:00:00",
        "step": 14,
        "p_above_2y": 0.5294117647058824,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 155.05078125,
        "Q1_dis": 170.6953125,
        "median_dis": 180.8828125,
        "Q3_dis": 190.07421875,
        "max_dis": 214.80859375,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-12-06T00:00:00",
        "step": 29,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 68.7109375,
        "Q1_dis": 85.1953125,
        "median_dis": 94.10546875,
        "Q3_dis": 104.0390625,
        "max_dis": 147.140625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-14T00:00:00",
        "step": 7,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 0.0392156862745098,
        "min_dis": 219.23046875,
        "Q1_dis": 228.1875,
        "median_dis": 232.1875,
        "Q3_dis": 239.83984375,
        "max_dis": 277.71484375,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-10T00:00:00",
        "step": 3,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 1.0,
        "min_dis": 276.0625,
        "Q1_dis": 284.25390625,
        "median_dis": 288.89453125,
        "Q3_dis": 297.17578125,
        "max_dis": 334.60546875,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-18T00:00:00",
        "step": 11,
        "p_above_2y": 1.0,
        "p_above_5y": 0.11764705882352941,
        "p_above_20y": 0.0,
        "min_dis": 180.69921875,
        "Q1_dis": 190.65625,
        "median_dis": 196.4375,
        "Q3_dis": 202.5234375,
        "max_dis": 247.62109375,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-23T00:00:00",
        "step": 16,
        "p_above_2y": 0.29411764705882354,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 138.88671875,
        "Q1_dis": 157.39453125,
        "median_dis": 163.30078125,
        "Q3_dis": 182.50390625,
        "max_dis": 206.859375,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-30T00:00:00",
        "step": 23,
        "p_above_2y": 0.0196078431372549,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 92.984375,
        "Q1_dis": 112.3984375,
        "median_dis": 122.24609375,
        "Q3_dis": 131.88671875,
        "max_dis": 179.765625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-20T00:00:00",
        "step": 13,
        "p_above_2y": 0.7254901960784313,
        "p_above_5y": 0.0392156862745098,
        "p_above_20y": 0.0,
        "min_dis": 164.18359375,
        "Q1_dis": 177.484375,
        "median_dis": 184.66015625,
        "Q3_dis": 193.66015625,
        "max_dis": 225.265625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-26T00:00:00",
        "step": 19,
        "p_above_2y": 0.058823529411764705,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 117.00390625,
        "Q1_dis": 135.9296875,
        "median_dis": 147.9140625,
        "Q3_dis": 158.28125,
        "max_dis": 191.10546875,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-29T00:00:00",
        "step": 22,
        "p_above_2y": 0.0196078431372549,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 98.40625,
        "Q1_dis": 117.59765625,
        "median_dis": 129.61328125,
        "Q3_dis": 138.37109375,
        "max_dis": 189.66796875,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-19T00:00:00",
        "step": 12,
        "p_above_2y": 0.8823529411764706,
        "p_above_5y": 0.058823529411764705,
        "p_above_20y": 0.0,
        "min_dis": 170.734375,
        "Q1_dis": 182.9296875,
        "median_dis": 189.50390625,
        "Q3_dis": 200.21484375,
        "max_dis": 237.8515625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-09T00:00:00",
        "step": 2,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 1.0,
        "min_dis": 292.87890625,
        "Q1_dis": 297.2890625,
        "median_dis": 300.2109375,
        "Q3_dis": 304.296875,
        "max_dis": 321.80859375,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-25T00:00:00",
        "step": 18,
        "p_above_2y": 0.0784313725490196,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 124.0234375,
        "Q1_dis": 142.0703125,
        "median_dis": 154.59765625,
        "Q3_dis": 165.51953125,
        "max_dis": 191.81640625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-11T00:00:00",
        "step": 4,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 0.9019607843137255,
        "min_dis": 259.66015625,
        "Q1_dis": 268.90625,
        "median_dis": 273.1953125,
        "Q3_dis": 281.76171875,
        "max_dis": 324.70703125,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-28T00:00:00",
        "step": 21,
        "p_above_2y": 0.0196078431372549,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 104.2109375,
        "Q1_dis": 124.3828125,
        "median_dis": 135.234375,
        "Q3_dis": 143.1875,
        "max_dis": 196.078125,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-12-01T00:00:00",
        "step": 24,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 87.90234375,
        "Q1_dis": 108.25390625,
        "median_dis": 117.51171875,
        "Q3_dis": 128.26171875,
        "max_dis": 175.390625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-12-03T00:00:00",
        "step": 26,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 78.6875,
        "Q1_dis": 99.703125,
        "median_dis": 107.3671875,
        "Q3_dis": 115.265625,
        "max_dis": 166.3984375,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-27T00:00:00",
        "step": 20,
        "p_above_2y": 0.058823529411764705,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 110.40234375,
        "Q1_dis": 130.40625,
        "median_dis": 140.3984375,
        "Q3_dis": 150.55078125,
        "max_dis": 192.07421875,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-13T00:00:00",
        "step": 6,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 0.058823529411764705,
        "min_dis": 230.8125,
        "Q1_dis": 241.4921875,
        "median_dis": 244.98828125,
        "Q3_dis": 253.43359375,
        "max_dis": 292.75390625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-08T00:00:00",
        "step": 1,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 1.0,
        "min_dis": 308.75,
        "Q1_dis": 308.76953125,
        "median_dis": 308.78125,
        "Q3_dis": 308.80078125,
        "max_dis": 310.00390625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-11-16T00:00:00",
        "step": 9,
        "p_above_2y": 1.0,
        "p_above_5y": 0.4117647058823529,
        "p_above_20y": 0.0,
        "min_dis": 198.44921875,
        "Q1_dis": 210.63671875,
        "median_dis": 215.1640625,
        "Q3_dis": 220.7890625,
        "max_dis": 261.80859375,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-07T00:00:00",
        "valid_time": "2023-12-04T00:00:00",
        "step": 27,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 74.828125,
        "Q1_dis": 94.59375,
        "median_dis": 102.078125,
        "Q3_dis": 110.671875,
        "max_dis": 160.6015625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
]

threshold_data = [
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "threshold_2y": 180.60302734375,
        "threshold_5y": 218.81761169433594,
        "threshold_20y": 268.388671875,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "threshold_2y": 178.55242919921875,
        "threshold_5y": 215.99989318847656,
        "threshold_20y": 264.57586669921875,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
]

# Convert WKT strings to geometries
for record in summary_data + detailed_data + threshold_data:
    record["geometry"] = wkt.loads(record["wkt"])
    record.pop("wkt")

# Create GeoDataFrames from the lists of dicts

# Summary data
gdf_test_summary = gpd.GeoDataFrame(summary_data, geometry="geometry")
gdf_test_summary["issued_on"] = pd.to_datetime(gdf_test_summary["issued_on"])
gdf_test_summary["peak_day"] = pd.to_datetime(gdf_test_summary["peak_day"])

# Detailed data
gdf_test_detailed = gpd.GeoDataFrame(detailed_data, geometry="geometry")
gdf_test_detailed["issued_on"] = pd.to_datetime(gdf_test_detailed["issued_on"])
gdf_test_detailed["valid_time"] = pd.to_datetime(gdf_test_detailed["valid_time"])

# Threshold data
gdf_test_threshold = gpd.GeoDataFrame(threshold_data, geometry="geometry")

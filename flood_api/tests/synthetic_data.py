import geopandas as gpd
import pandas as pd
from shapely import wkt

summary_data = [
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "peak_step": 1,
        "peak_day": "2023-11-10",
        "peak_timing": "BB",
        "max_median_dis": 293.4921875,
        "min_median_dis": 84.7578125,
        "control_dis": 293.4921875,
        "max_max_dis": 293.50390625,
        "min_min_dis": 66.46875,
        "tendency": "D",
        "max_p_above_20y": 1.0,
        "max_p_above_5y": 1.0,
        "max_p_above_2y": 1.0,
        "intensity": "P",
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "peak_step": 1,
        "peak_day": "2023-11-10",
        "peak_timing": "BB",
        "max_median_dis": 288.1328125,
        "min_median_dis": 83.921875,
        "control_dis": 288.1328125,
        "max_max_dis": 288.1484375,
        "min_min_dis": 66.015625,
        "tendency": "D",
        "max_p_above_20y": 1.0,
        "max_p_above_5y": 1.0,
        "max_p_above_2y": 1.0,
        "intensity": "P",
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
]

detailed_data = [
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-19",
        "step": 10,
        "p_above_2y": 1.0,
        "p_above_5y": 0.17647058823529413,
        "p_above_20y": 0.0,
        "min_dis": 181.85546875,
        "q1_dis": 194.12890625,
        "median_dis": 203.1171875,
        "q3_dis": 213.8359375,
        "max_dis": 234.84765625,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-21",
        "step": 12,
        "p_above_2y": 0.7450980392156863,
        "p_above_5y": 0.058823529411764705,
        "p_above_20y": 0.0,
        "min_dis": 165.5234375,
        "q1_dis": 180.17578125,
        "median_dis": 192.76171875,
        "q3_dis": 203.6953125,
        "max_dis": 222.61328125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-12-09",
        "step": 30,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 66.46875,
        "q1_dis": 76.26953125,
        "median_dis": 84.7578125,
        "q3_dis": 92.88671875,
        "max_dis": 113.65625,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-27",
        "step": 18,
        "p_above_2y": 0.0196078431372549,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 119.70703125,
        "q1_dis": 136.33203125,
        "median_dis": 145.79296875,
        "q3_dis": 157.08984375,
        "max_dis": 191.80078125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-25",
        "step": 16,
        "p_above_2y": 0.09803921568627451,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 134.59375,
        "q1_dis": 148.671875,
        "median_dis": 159.56640625,
        "q3_dis": 174.55859375,
        "max_dis": 208.54296875,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-14",
        "step": 5,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 0.0,
        "min_dis": 232.6328125,
        "q1_dis": 239.58203125,
        "median_dis": 243.7734375,
        "q3_dis": 250.7890625,
        "max_dis": 264.7421875,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-12",
        "step": 3,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 0.09803921568627451,
        "min_dis": 259.57421875,
        "q1_dis": 261.75390625,
        "median_dis": 263.5390625,
        "q3_dis": 265.796875,
        "max_dis": 272.08203125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-16",
        "step": 7,
        "p_above_2y": 1.0,
        "p_above_5y": 0.7647058823529411,
        "p_above_20y": 0.0,
        "min_dis": 212.1171875,
        "q1_dis": 219.03515625,
        "median_dis": 224.69921875,
        "q3_dis": 235.8515625,
        "max_dis": 253.87890625,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-12-07",
        "step": 28,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 73.5078125,
        "q1_dis": 84.0546875,
        "median_dis": 92.76953125,
        "q3_dis": 100.109375,
        "max_dis": 125.171875,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-12-08",
        "step": 29,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 69.703125,
        "q1_dis": 80.109375,
        "median_dis": 88.8828125,
        "q3_dis": 97.0078125,
        "max_dis": 119.61328125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-18",
        "step": 9,
        "p_above_2y": 1.0,
        "p_above_5y": 0.2549019607843137,
        "p_above_20y": 0.0,
        "min_dis": 189.515625,
        "q1_dis": 201.203125,
        "median_dis": 207.5234375,
        "q3_dis": 219.93359375,
        "max_dis": 237.0546875,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-26",
        "step": 17,
        "p_above_2y": 0.0196078431372549,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 126.8984375,
        "q1_dis": 143.03515625,
        "median_dis": 150.38671875,
        "q3_dis": 164.953125,
        "max_dis": 201.234375,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-28",
        "step": 19,
        "p_above_2y": 0.0196078431372549,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 113.1484375,
        "q1_dis": 129.1484375,
        "median_dis": 138.4765625,
        "q3_dis": 149.90234375,
        "max_dis": 180.78515625,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-12-03",
        "step": 24,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 87.5625,
        "q1_dis": 103.3515625,
        "median_dis": 110.828125,
        "q3_dis": 121.4453125,
        "max_dis": 156.80078125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-17",
        "step": 8,
        "p_above_2y": 1.0,
        "p_above_5y": 0.37254901960784315,
        "p_above_20y": 0.0,
        "min_dis": 200.22265625,
        "q1_dis": 207.92578125,
        "median_dis": 214.4609375,
        "q3_dis": 225.43359375,
        "max_dis": 242.1328125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-13",
        "step": 4,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 0.0,
        "min_dis": 244.16796875,
        "q1_dis": 248.33203125,
        "median_dis": 251.25390625,
        "q3_dis": 254.75,
        "max_dis": 263.40234375,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-12-04",
        "step": 25,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 84.37109375,
        "q1_dis": 99.1796875,
        "median_dis": 106.42578125,
        "q3_dis": 115.8125,
        "max_dis": 149.3125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-10",
        "step": 1,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 1.0,
        "min_dis": 293.4921875,
        "q1_dis": 293.4921875,
        "median_dis": 293.4921875,
        "q3_dis": 293.49609375,
        "max_dis": 293.50390625,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-15",
        "step": 6,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 0.0,
        "min_dis": 223.49609375,
        "q1_dis": 229.390625,
        "median_dis": 235.38671875,
        "q3_dis": 244.23046875,
        "max_dis": 266.265625,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-12-06",
        "step": 27,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 77.2578125,
        "q1_dis": 88.8984375,
        "median_dis": 98.0078125,
        "q3_dis": 104.93359375,
        "max_dis": 132.734375,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-23",
        "step": 14,
        "p_above_2y": 0.39215686274509803,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 151.015625,
        "q1_dis": 162.140625,
        "median_dis": 174.34765625,
        "q3_dis": 190.7734375,
        "max_dis": 205.1328125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-29",
        "step": 20,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 107.37890625,
        "q1_dis": 123.28515625,
        "median_dis": 131.37109375,
        "q3_dis": 142.9609375,
        "max_dis": 170.125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-12-02",
        "step": 23,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 91.08203125,
        "q1_dis": 108.9296875,
        "median_dis": 116.67578125,
        "q3_dis": 126.8203125,
        "max_dis": 162.203125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-12-01",
        "step": 22,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 96.171875,
        "q1_dis": 114.32421875,
        "median_dis": 121.1796875,
        "q3_dis": 132.57421875,
        "max_dis": 165.48828125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-22",
        "step": 13,
        "p_above_2y": 0.5294117647058824,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 159.62109375,
        "q1_dis": 170.6640625,
        "median_dis": 184.77734375,
        "q3_dis": 198.17578125,
        "max_dis": 216.21484375,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-30",
        "step": 21,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 101.77734375,
        "q1_dis": 117.9609375,
        "median_dis": 126.8515625,
        "q3_dis": 137.12109375,
        "max_dis": 170.36328125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-11",
        "step": 2,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 1.0,
        "min_dis": 275.7109375,
        "q1_dis": 276.34375,
        "median_dis": 276.87109375,
        "q3_dis": 277.55859375,
        "max_dis": 279.46484375,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-12-05",
        "step": 26,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 81.2265625,
        "q1_dis": 93.9921875,
        "median_dis": 101.8671875,
        "q3_dis": 109.9375,
        "max_dis": 140.83203125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-20",
        "step": 11,
        "p_above_2y": 0.8627450980392157,
        "p_above_5y": 0.09803921568627451,
        "p_above_20y": 0.0,
        "min_dis": 173.0390625,
        "q1_dis": 186.390625,
        "median_dis": 197.59375,
        "q3_dis": 210.34375,
        "max_dis": 232.48828125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-24",
        "step": 15,
        "p_above_2y": 0.27450980392156865,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 142.65625,
        "q1_dis": 156.453125,
        "median_dis": 166.25,
        "q3_dis": 181.390625,
        "max_dis": 197.8203125,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-12-08",
        "step": 29,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 69.2265625,
        "q1_dis": 79.359375,
        "median_dis": 88.0546875,
        "q3_dis": 95.9921875,
        "max_dis": 117.85546875,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-24",
        "step": 15,
        "p_above_2y": 0.2549019607843137,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 140.62890625,
        "q1_dis": 154.4140625,
        "median_dis": 163.79296875,
        "q3_dis": 178.5859375,
        "max_dis": 195.08984375,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-12",
        "step": 3,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 0.058823529411764705,
        "min_dis": 254.96875,
        "q1_dis": 257.14453125,
        "median_dis": 258.953125,
        "q3_dis": 261.1484375,
        "max_dis": 267.33203125,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-10",
        "step": 1,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 1.0,
        "min_dis": 288.1328125,
        "q1_dis": 288.1328125,
        "median_dis": 288.1328125,
        "q3_dis": 288.13671875,
        "max_dis": 288.1484375,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-14",
        "step": 5,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 0.0,
        "min_dis": 228.67578125,
        "q1_dis": 235.58984375,
        "median_dis": 239.7578125,
        "q3_dis": 246.5546875,
        "max_dis": 260.09765625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-17",
        "step": 8,
        "p_above_2y": 1.0,
        "p_above_5y": 0.37254901960784315,
        "p_above_20y": 0.0,
        "min_dis": 196.9921875,
        "q1_dis": 204.58203125,
        "median_dis": 210.90625,
        "q3_dis": 221.43359375,
        "max_dis": 238.12890625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-15",
        "step": 6,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 0.0,
        "min_dis": 219.765625,
        "q1_dis": 225.578125,
        "median_dis": 231.41796875,
        "q3_dis": 240.21484375,
        "max_dis": 262.15234375,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-22",
        "step": 13,
        "p_above_2y": 0.5294117647058824,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 157.234375,
        "q1_dis": 167.8984375,
        "median_dis": 181.70703125,
        "q3_dis": 195.32421875,
        "max_dis": 212.6796875,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-30",
        "step": 21,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 100.60546875,
        "q1_dis": 116.5703125,
        "median_dis": 124.68359375,
        "q3_dis": 135.0546875,
        "max_dis": 167.58984375,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-20",
        "step": 11,
        "p_above_2y": 0.8431372549019608,
        "p_above_5y": 0.09803921568627451,
        "p_above_20y": 0.0,
        "min_dis": 170.36328125,
        "q1_dis": 183.38671875,
        "median_dis": 194.78125,
        "q3_dis": 207.13671875,
        "max_dis": 229.0859375,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-19",
        "step": 10,
        "p_above_2y": 1.0,
        "p_above_5y": 0.17647058823529413,
        "p_above_20y": 0.0,
        "min_dis": 179.04296875,
        "q1_dis": 191.1796875,
        "median_dis": 199.85546875,
        "q3_dis": 210.7109375,
        "max_dis": 231.4140625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-12-04",
        "step": 25,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 83.58203125,
        "q1_dis": 97.921875,
        "median_dis": 105.22265625,
        "q3_dis": 114.4453125,
        "max_dis": 146.9296875,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-23",
        "step": 14,
        "p_above_2y": 0.37254901960784315,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 148.80859375,
        "q1_dis": 159.84375,
        "median_dis": 171.4921875,
        "q3_dis": 187.94140625,
        "max_dis": 201.7265625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-12-02",
        "step": 23,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 90.1328125,
        "q1_dis": 107.66015625,
        "median_dis": 115.3359375,
        "q3_dis": 124.87890625,
        "max_dis": 159.66015625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-12-01",
        "step": 22,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 95.109375,
        "q1_dis": 113.1328125,
        "median_dis": 119.71875,
        "q3_dis": 130.73046875,
        "max_dis": 162.796875,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-12-03",
        "step": 24,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 86.6953125,
        "q1_dis": 101.9609375,
        "median_dis": 109.4765625,
        "q3_dis": 119.75,
        "max_dis": 154.29296875,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-21",
        "step": 12,
        "p_above_2y": 0.7254901960784313,
        "p_above_5y": 0.058823529411764705,
        "p_above_20y": 0.0,
        "min_dis": 163.0,
        "q1_dis": 177.56640625,
        "median_dis": 189.6875,
        "q3_dis": 200.19140625,
        "max_dis": 219.3671875,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-12-07",
        "step": 28,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 72.9609375,
        "q1_dis": 83.2578125,
        "median_dis": 91.7734375,
        "q3_dis": 99.1640625,
        "max_dis": 123.31640625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-18",
        "step": 9,
        "p_above_2y": 1.0,
        "p_above_5y": 0.2549019607843137,
        "p_above_20y": 0.0,
        "min_dis": 186.5078125,
        "q1_dis": 198.04296875,
        "median_dis": 204.37109375,
        "q3_dis": 216.30078125,
        "max_dis": 233.29296875,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-28",
        "step": 19,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 111.74609375,
        "q1_dis": 127.55859375,
        "median_dis": 136.6015625,
        "q3_dis": 147.61328125,
        "max_dis": 178.09765625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-12-06",
        "step": 27,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 76.625,
        "q1_dis": 88.0,
        "median_dis": 96.90625,
        "q3_dis": 103.75390625,
        "max_dis": 130.7109375,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-12-09",
        "step": 30,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 66.015625,
        "q1_dis": 75.8046875,
        "median_dis": 83.921875,
        "q3_dis": 92.0703125,
        "max_dis": 112.0078125,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-29",
        "step": 20,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 106.09765625,
        "q1_dis": 121.65234375,
        "median_dis": 129.921875,
        "q3_dis": 140.7734375,
        "max_dis": 167.6328125,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-26",
        "step": 17,
        "p_above_2y": 0.0196078431372549,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 125.19921875,
        "q1_dis": 141.23828125,
        "median_dis": 148.53515625,
        "q3_dis": 162.5078125,
        "max_dis": 198.26953125,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-25",
        "step": 16,
        "p_above_2y": 0.09803921568627451,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 132.734375,
        "q1_dis": 146.69921875,
        "median_dis": 157.54296875,
        "q3_dis": 171.92578125,
        "max_dis": 205.66015625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-27",
        "step": 18,
        "p_above_2y": 0.0196078431372549,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 118.1640625,
        "q1_dis": 134.609375,
        "median_dis": 143.4375,
        "q3_dis": 154.9921875,
        "max_dis": 188.92578125,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-11",
        "step": 2,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 1.0,
        "min_dis": 270.75,
        "q1_dis": 271.375,
        "median_dis": 271.9140625,
        "q3_dis": 272.5859375,
        "max_dis": 274.5234375,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-12-05",
        "step": 26,
        "p_above_2y": 0.0,
        "p_above_5y": 0.0,
        "p_above_20y": 0.0,
        "min_dis": 80.52734375,
        "q1_dis": 92.9921875,
        "median_dis": 100.59375,
        "q3_dis": 108.51171875,
        "max_dis": 138.625,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-13",
        "step": 4,
        "p_above_2y": 1.0,
        "p_above_5y": 1.0,
        "p_above_20y": 0.0,
        "min_dis": 239.890625,
        "q1_dis": 244.05859375,
        "median_dis": 246.890625,
        "q3_dis": 250.234375,
        "max_dis": 259.0,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "issued_on": "2023-11-10",
        "valid_for": "2023-11-16",
        "step": 7,
        "p_above_2y": 1.0,
        "p_above_5y": 0.7450980392156863,
        "p_above_20y": 0.0,
        "min_dis": 208.6015625,
        "q1_dis": 215.54296875,
        "median_dis": 220.953125,
        "q3_dis": 231.80859375,
        "max_dis": 249.79296875,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
]

threshold_data = [
    {
        "latitude": 6.225,
        "longitude": 39.075,
        "threshold_2y": 180.60302734375,
        "threshold_5y": 218.81761169433594,
        "threshold_20y": 268.388671875,
        "wkt": "POLYGON ((39.05 6.2,39.05 6.25,39.1 6.25,39.1 6.2,39.05 6.2))",
    },
    {
        "latitude": 6.275,
        "longitude": 39.075,
        "threshold_2y": 178.55242919921875,
        "threshold_5y": 215.99989318847656,
        "threshold_20y": 264.57586669921875,
        "wkt": "POLYGON ((39.05 6.25,39.05 6.3,39.1 6.3,39.1 6.25,39.05 6.25))",
    },
]

# Convert WKT strings to geometries
for record in summary_data + detailed_data + threshold_data:
    record["geometry"] = wkt.loads(record["wkt"])
    record.pop("wkt")

# Create GeoDataFrames from the lists of dicts

# Summary data
gdf_test_summary = gpd.GeoDataFrame(summary_data, geometry="geometry")
gdf_test_summary["issued_on"] = pd.to_datetime(gdf_test_summary["issued_on"]).dt.date
gdf_test_summary["peak_day"] = pd.to_datetime(gdf_test_summary["peak_day"]).dt.date

# Detailed data
gdf_test_detailed = gpd.GeoDataFrame(detailed_data, geometry="geometry")
gdf_test_detailed["issued_on"] = pd.to_datetime(gdf_test_detailed["issued_on"]).dt.date
gdf_test_detailed["valid_for"] = pd.to_datetime(gdf_test_detailed["valid_for"]).dt.date

# Threshold data
gdf_test_threshold = gpd.GeoDataFrame(threshold_data, geometry="geometry")
